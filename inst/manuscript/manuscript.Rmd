---
documentclass: jss
author:
    # use this syntax to add text on several lines
    # To add another line, use \AND at the end of the previous one as above
    # use a different affiliation in adress field (differently formated here)
  - name: Michael Dumelle
    orcid: 0000-0002-3393-5529
    affiliation: |
      | United States
      | Environmental Protection Agency
    address: |
      | 200 SW 35th St
      | Corvallis, OR, 97330
    email: \email{Dumelle.Michael@epa.gov}
  - name: Jay M. Ver Hoef
    orcid: 0000-0003-4302-6895
    affiliation: |
      | Alaska Fisheries
      | Science Center
  - name: Matt Higham
    orcid: 0009-0006-4217-625X
    affiliation: |
      | St. Lawrence University
title:
  # If you use tex in the formatted title, also supply version without
  # For running headers, if needed
  formatted: "Spatial Generalized Linear Models in \\proglang{R} Using \\pkg{spmodel}"
  plain:     "Spatial Generalized Linear Models in R Using spmodel"
  short:     "Spatial Generalized Linear Models in \\proglang{R} Using \\pkg{spmodel}"
abstract: |
  Generalized linear models (GLMs) describe a non-normal response variable that may be binary, count, skewed, or a proportion. Typically, observations in a GLM are assumed independent of one another. For spatial data, this independence assumption is impractical, as nearby locations tend to be more similar than locations far apart. The \pkg{spmodel} \proglang{R} package provides tools to fit GLMs that incorporate spatial correlation (i.e., spatial generalized linear models, or SPGLMs). SPGLMs are fit in \pkg{spmodel} using a novel application of the Laplace approximation via \code{spglm()} for point-referenced data or \code{spgautor()} for areal (i.e., lattice), data. \code{spglm()} and \code{spgautor()} closely resemble [glm]{.fct} from base \proglang{R} but include arguments that control the spatial correlation structure. \pkg{spmodel} has many helper functions for model inspection and diagnostics, some of which leverage other \proglang{R} packages like [broom]{.pkg} and [emmeans]{.pkg}. \pkg{spmodel} has tools to make predictions of the latent spatial-mean process at unobserved locations. \pkg{spmodel} also provides many advanced features like accommodating geometric anisotropy and nonspatial random effects, simulating spatially autocorrelated data, and more. Here we use \pkg{spmodel} to illustrate the modeling of binary, count, skewed and proportion response variables from several point-referenced and areal data sets. 
keywords:
  # at least one keyword must be supplied
  formatted: [autoregressive model, geostatistical model, spatial covariance, spatial correlation]
  plain:     [autoregressive model, geostatistical model, spatial covariance, spatial correlation]
preamble: |
  \usepackage{amsmath,amsfonts,amssymb}
  \usepackage{bm, bbm}
  \usepackage{lineno}
  \usepackage{caption, subcaption}
output: rticles::jss_article
editor_options: 
  chunk_output_type: console
---

```{r, setup, include=FALSE}
options(prompt = 'R> ', continue = '+ ')
library(spmodel)
library(ggplot2)
library(dplyr)
library(emmeans)
library(here)
fig_path <- here("inst", "manuscript", "figures")
```

\newpage

# Introduction {#sec-intro}

In practice, non-Gaussian data are ubiquitous. Non-Gaussian that belong to an exponential family data can be naturally modeled using a generalized linear model (GLM) regression framework [@nelder1972generalized; @mccullagh1989generalized; @myers2012generalized; @faraway2016extending]. In a GLM, an $n \times 1$ response variable $\mathbf{y}$ belongs to a a statistical distribution (e.g., Poisson, Binomial) with some mean and variance. Often, the analysis goal is to study the impact of a linear function of several explanatory variables on $\text{y}$ through a GLM. In this context, the latent (i.e., unobserved) mean of $\mathbf{y}$, $\boldsymbol{\mu}$, is linked to these explanatory variables via a link function:
\begin{equation}\label{eq-glm}
f(\boldsymbol{\mu}|\mathbf{X}, \boldsymbol{\beta}) \equiv \mathbf{w} = \mathbf{X} \boldsymbol{\beta},
\end{equation}
where for a sample size $n$, $f(\cdot)$ is a link function that connects $\boldsymbol{\mu}$ to $\mathbf{w}$, $\mathbf{X}$ is the $n \times p$ design matrix of explanatory variables, and $\boldsymbol{\beta}$ is the $p \times 1$ vector of fixed effects. While the mean is typically constrained in some way (e.g., between zero and one if a probability), the link function generally makes $\mathbf{w}$ is unconstrained. Common link functions inlude the log odds (i.e., logit) link for binary and proprtion data and the log link count and skewed data. Equation$~$\ref{eq-glm} can also be written in terms of the inverse link function, $f^{-1}(\cdot)$:
\begin{equation}\label{eq-glm2}
\boldsymbol{\mu}|\mathbf{X}, \boldsymbol{\beta} \equiv f^{-1}(\mathbf{w}) = f^{-1}(\mathbf{X} \boldsymbol{\beta}),
\end{equation}

The GLM fixed effects ($\boldsymbol{\beta}$) are typically estimated via maximum likelihood [@chambers1992S]. It is often convenient to compute the maximum likelihood estimates using the iteratively reweighted least squares (IRWLS) algorithm [@wood2017generalized], which is the approach used by the  \code{glm()} function in the \proglang{R} programming language [@rcore2024]. GLMs add an additional layer of complexity compared to linear regression models, as the left-hand size of Equation$~$\ref{eq-glm} is a function of the mean of $\mathbf{y}$ rather than $\mathbf{y}$ itself (as in linear regression models).

The standard GLM assumes the elements of $\mathbf{y}$ are independent. This independence assumption is typically impractical for spatial data. In spatial data, nearby observations tend to be more similar than distant observations [@tobler1970computer], leading to positive spatial covariance among observations. The consequences of ignoring spatial covariance in statistical models for spatial data can be severe and include imprecise parameter estimates as well as misleading standard errors that inflate Type-I error rates and decrease power [@zimmerman2024spatial].

An approach for handling spatial data using a GLM is to assume $\mathbf{w}$ has spatial covariance. This is achieved by adding to Equation$~$\ref{eq-glm} two random effects, $\boldsymbol{\tau}$ and $\boldsymbol{\epsilon}$. The random effect $\boldsymbol{\tau}$ is an $n \times 1$ column vector of spatially dependent random errors. We assume that $\text{E}(\boldsymbol{\tau}) = \boldsymbol{0}$ and $\text{Cov}(\boldsymbol{\tau}) = \sigma^2_\tau \mathbf{R}$, where $\text{E}(\cdot)$ and $\text{Cov}(\cdot)$ denote expectation and covariance, respectively. The variance parameter $\sigma^2_\tau$ controls the magnitude of spatial covariance and is often called a partial sill, while the matrix $\mathbf{R}$ is an $n \times n$ spatial correlation matrix that depends on a range parameter controls the distance-decay rate of the spatial correlation. One example of a spatial covariance matrix is the "exponential", which is given by
\begin{equation}\label{eq-spcov-exp}
  \text{Cov}(\boldsymbol{\tau}) = \sigma^2_{de} \exp(-\mathbf{H}/\phi),
\end{equation}
where $\mathbf{H}$ is a matrix of pairwise distances among the elements of $\mathbf{y}$ and $\phi$ is a range parameter. From Equation$~$\ref{eq-spcov-exp}, as the distance between two elements of $\mathbf{y}$ increases, the spatial covariance decreases, which reflects intuition. Moreover, as the range parameter, $\phi$, increases, the strength of spatial dependence increases (Figure$~$\ref{fig-range}). The random effect $\boldsymbol{\epsilon}$ is an $n \times 1$ column vector of independent random errors. We assume that $\text{E}(\boldsymbol{\epsilon}) = \boldsymbol{0}$ and $\text{Cov}(\boldsymbol{\tau}) = \sigma^2_\epsilon \mathbf{I}$, where $\mathbf{I}$ is an $n \times n$ identity matrix. The variance parameter $\sigma^2_\epsilon$ controls the magnitude of nonspatial variability (i.e., fine-scale variation) and is often called a nugget. 

\begin{figure}
\centering
\includegraphics[width = 0.7\linewidth]{figures/figure-01.png}
\caption{An exponential spatial correlation function with varying range parameters.}
\label{fig-range}
\end{figure}

Through inclusion of $\boldsymbol{\tau}$ and $\boldsymbol{\epsilon}$, the spatial GLM (SPGLM) can be written as
\begin{equation}\label{eq-spglm}
f(\boldsymbol{\mu}|\mathbf{X}, \boldsymbol{\beta}, \boldsymbol{\tau}, \boldsymbol{\epsilon}) \equiv \mathbf{w} = \mathbf{X} \boldsymbol{\beta} + \boldsymbol{\tau} + \boldsymbol{\epsilon}.
\end{equation}
Often in spatial statistics, quantities are explicitly referenced with respect to $\mathbf{s}$, a vector of coordinates indexing the observation [@cressie1993statistics]. For example, $\mathbf{y}$ and $\mathbf{X}$ may instead be written $\mathbf{y}(\mathbf{s})$ and $\mathbf{X}$, respectively. We acknowledge the utility of this nomenclature but drop the explicit dependence on $\mathbf{s}$ for simplicity of notation.
Assuming independence among $\boldsymbol{\tau}$ and $\boldsymbol{\epsilon}$, it follows that 
\begin{equation}\label{eq-spcov}
 \text{Cov}(\boldsymbol{\tau} + \boldsymbol{\epsilon}) = \text{Cov}(\boldsymbol{\tau}) + \text{Cov}(\boldsymbol{\epsilon}) = \sigma^2_{\tau}\mathbf{R} + \sigma^2_{\epsilon} \mathbf{I}.
\end{equation}
To better align with intuition, we henceforth $\sigma^2_{\tau}$ as $\sigma^2_{de}$ (for spatial error variance) and $\sigma^2_{\epsilon}$ as $\sigma^2_{ie}$ (for independent error variance). The parameters $\sigma^2_{de}$, $\sigma^2_{ie}$, the range parameter $\phi$ in $\mathbf{R}$, and any other parameters in $\mathbf{R}$ compose $\boldsymbol{\theta}$, the covariance parameter vector. 

Fitting and using SPGLMs is challenging both conceptually and computationally [@bolker2009generalized]. Recently, however, there have been numerous, significant advances in \proglang{R} software that have made these models more accessible to practitioners. The \pkg{brms} [@burkner2017brms], \pkg{carBayes} [@lee2013carbayes], \pkg{ngspatial} [@hughes2020ngspatial], \pkg{R-INLA} [@lindgren2015bayesian] and \pkg{inlabru} [@bachl2019inlabru], \pkg{spBayes} [@finley2007spbayes], \pkg{spOccupancy} [@doser2022spoccupancy], \pkg{spAbundance} [@doser2024spabundance], and \pkg{spNNGP} [@finley2002spnngp] packages take a Bayesian approach, either directly sampling from posterior distributions of parameters (e.g., using MCMC) or approximating them. A benefit of Bayesian approaches is that prior information can be incorporated and uncertainty quantification of parameter estimates is straightforward. However, Bayesian approaches, especially those using MCMC, can be computationally expensive. In order to reduce computation time, many of these packages work with the precision matrix instead of the covariance matrix so that computationally expensive matrix inversion is not required. For example, \pkg{R-INLA} uses the precision matrix and tends to be very fast. Working with precision matrices, however, can be more restrictive and less intuitive than working directly with the covariance matrix. The [FRK]{.pkg} [@sainsbury2024modeling], \pkg{glmmTMB} [@brooks2017glmmtmb], \pkg{hglm} [@ronnegard2010hglm], \pkg{mgcv} [@wood2017generalized], and \pkg{spaMM} [@rousset2014spamm] packages directly use Laplace, quasi-likelihood, or reduced-rank approaches to estimate parameters. These direct approaches tend to be computationally efficient, as they don't rely on MCMC sampling. In contrast to the Bayesian approach, a drawback of these direct approaches is that prior information cannot be formally incorporated and covariance parameter uncertainty is more challenging to quantify. The \pkg{sdmTMB} [@anderson2024sdmtmb] package combines elements of \pkg{R-INLA}, \pkg{glmmTMB}, and properties of Gaussian Markov random fields to fit a wide variety of SPGLMs, and \pkg{tinyVAST} [@thorson2025tinyVAST] extends some of these models to multivariate or (dynamic) structural equation models.

@ver2024marginal proposed a novel approach to fitting SPGLMs that leverages the Laplace approximation while marginalizing over both the latent $\mathbf{w}$ and the fixed effects ($\boldsymbol{\beta}$) and accommodating spatial covariance. @ver2024marginal showed that this approach performed efficiently in a variety of simulation settings, generally having appropriate confidence interval coverage for the fixed effects and prediction interval coverage for new $\mathbf{w}$. The approach performed similarly to the Bayesian SPGLM approach in \pkg{spBayes} and the automatic differentiation SPGLM approach in \pkg{glmmTMB} but was much faster. At small sample sizes, the approach outperformed the approximate Bayesian SPGLM approach in \pkg{R-INLA} and had similar computational times. For moderate sample sizes, it performed similarly to \pkg{R-INLA}, though \pkg{R-INLA} was faster. This novel approach is particularly attractive for two reasons. First, it is general enough that can be applied to any covariance structure (not just spatial). Second, after estimating the covariance parameters, analytical solutions exist for the fixed effects (and their standard errors) as well as predictions of the latent $\mathbf{w}$ at new locations (and their standard errors). The \pkg{spmodel} \proglang{R} package [@dumelle2023spmodel] recently provided full support for the methods in @ver2024marginal applied to binary, count, skewed, and proportion data for over 20 different spatial covariance types.

The \pkg{spmodel} \proglang{R} package [@dumelle2023spmodel] recently provided a full set of modeling tools for SPGLMs fit using the methods described in @ver2024marginal. These modeling tools are approachable and mirror the familiar \code{glm()} syntax from base-\proglang{R}, making the transition from GLMs to SPGLMs relatively seamless. The \code{spglm()} function fits SPGLMs for point-referenced data (e.g., x-coordinates and y-coordinates representing point locations in a field), while the \code{spgautor()} function fits SPGLMs for areal data (e.g., polygon boundaries representing geographic subsets of a region). \pkg{spmodel} supports the binomial distribution for binary data, Poisson and negative binomial distributions for count data, Gamma and inverse Gaussian distributions for skewed data, and the beta distribution for proportion data. There are 20 different spatial covariance structures available including the exponential, Gaussian, and spherical for point-referenced data (Figure$~$\ref{fig-type}) and the conditional autoregressive, and simultaneous autoregressive structures for areal data. \pkg{spmodel} provides tools for commonly used model summaries, visualizations, and diagnostics (e.g., Cook's distance) using standard \proglang{R} helper functions like \code{summary()}, \code{plot()}, and \code{cooks.distance()}. \pkg{spmodel} also provides tools to predict $\mathbf{w}$ at new locations and quantify uncertainty in those prediction using \code{predict()}. This core functionality, combined with several advanced features we describe throughout the manuscript, enable \pkg{spmodel} to provide some novel and important capabilities previously missing from the existing SPGLM ecosystem in \proglang{R}.

\begin{figure}
\centering
\includegraphics[width = 0.7\linewidth]{figures/figure-02.png}
\caption{Exponential, Gaussian, and spherical spatial correlation functions all with range parameters equal to 0.5.}
\label{fig-type}
\end{figure}

\pkg{spmodel} (version 0.11.0) is arguably most similar to \pkg{sdmTMB} (version 0.7.4) in terms of scope and feel. Both packages use similar syntax as \code{glm()}, accommodate flexible \code{formula} arguments (e.g., offsets, splines), handle spatial covariance that decays at different rates in different rates (i.e., geometric anisotropy), incorporate nonspatial random effects, support other \proglang{R} packages for modeling like \pkg{broom} [@robinson2021broom; @kuhn2022tidy] and \pkg{emmeans} [@lenth2024emmeans], and have tools for model summaries, prediction, and simulating data. There are some notable differences between the two packages, however. \pkg{sdmTMB} supports several additional GLM distributions like the Tweedie, supports Hurdle models, and can incorporate prior information through Bayesian applications. \pkg{sdmTMB} also provides tools for working with temporal data and enhanced visualizations of marginal effects. \pkg{sdmTMB} does require a preprocessing step of constructing a mesh for the stochastic partial differential equation approach, and the density of the mesh can affect model results and computational complexity. \pkg{spmodel} does not require the construction of a mesh prior to modeling. \pkg{spmodel} supports 20 different spatial covariances and models them directly, rather than using a precision matrix approximation to the MatÃ©rn spatial covariance as in \pkg{sdmTMB}. \pkg{spmodel} also provides experimental design tools (e.g., analysis of variance, contrasts), supports \pkg{sf} objects in modeling and prediction functions [@pebesma2018sf], has several specialized model diagnostics like leverage values and Cook's distances, and has analytic solutions for prediction standard errors. Other similarities and differences do exist between \pkg{sdmTMB} and \pkg{spmodel}, and both packages continue to evolve. Overall, we believe that these packages are complementary and enhance the suite of SPGLM tools accessible to practitioners.

The rest of this article is organized as follows. In Section$~$\ref{sec-spglm}, we provide some background for the SPGLM fitting and prediction routines in \pkg{spmodel}. In Section$~$\ref{sec-applications}, we provide several applications of \pkg{spmodel} to spatial binary, count, skewed and proportion data with both point-referenced and areal supports. And in Section$~$\ref{sec-discussion}, we end with a discussion synthesizing \pkg{spmodel}'s contributions to the analysis of SPGLMs in \proglang{R}.

# The spatial generalized linear model and marginalizatoin {#sec-spglm}

\pkg{spmodel} implements the novel methods described in @ver2024marginal to fit SPGLMs, which leverages the Laplace approximation and marginalizes over both the latent $\mathbf{w}$ and the fixed effects while accommodating spatial covariance. A beneficial aspect of this approach is that it formally maximizes a hierarchical GLM likelihood [@lee1996hierarchical; @wood2017generalized]. This makes likelihood-based statistics for model comparison like AIC [@akaike1974new], AICc [@hoeting2006model], BIC [@schwarz1978estimating], deviance [@mccullagh1989generalized], and likelihood ratio tests available. These types of statistics are not available for quasi-likelihood [@wedderburn1974quasi; @breslow1993approximate] or pseudo-likelihood approaches [@wolfinger1993generalized], which only specify the first two moments of a distribution. @ver2024marginal provides thorough details regarding the method and contextualizes its development which built upon similar methods [@evangelou2011estimation, @bonat2016practical]. Next, we describe a brief overview of the approach and how it can be used for parameter estimation, inference, and prediction.

## Formulating the hierarchical likelihood

We can write the SPGLM likelihood hierarchically as
\begin{equation}\label{eq-marginal}
  [\mathbf{y}|\mathbf{X}, \varphi, \boldsymbol{\theta}] = \int_{\mathbf{w}} \int_{\boldsymbol{\beta}} [\mathbf{y} | f^{-1}(\mathbf{w}), \varphi] [\mathbf{w} | \mathbf{X}, \boldsymbol{\theta}] d\boldsymbol{\beta} d\mathbf{w},
\end{equation}
where $[\mathbf{y} | f^{-1}(\mathbf{w}), \varphi]$ is the density for the appropriate response distribution of $\mathbf{y}$ (e.g., binomial, Poisson) given the latent $\mathbf{w}$ and dispersion parameter ($\varphi$), and $[\mathbf{w} | \mathbf{X}, \boldsymbol{\theta}]$ is the multivariate Gaussian density for $\mathbf{w}$ given the explanatory variables ($\mathbf{X}$), fixed effects ($\boldsymbol{\beta}$), and spatial covariance parameters ($\boldsymbol{\theta}$). Following @@harville1977maximum, we can integrate $\boldsymbol{\beta}$ out of Equation$~$\ref{eq-spglm}, which yields
\begin{equation}\label{eq-marginal2}
  [\mathbf{y}|\mathbf{X}, \varphi, \boldsymbol{\theta}] = \int_{\mathbf{w}} [\mathbf{y} | f^{-1}(\mathbf{w}), \varphi] [\mathbf{w} | \mathbf{X}, \boldsymbol{\theta}] d\mathbf{w},
\end{equation}
where $[\mathbf{w} | \mathbf{X}, \boldsymbol{\theta}]$ is the restricted (i.e., residual) multivariate Gaussian density [@patterson1971recovery] for $\mathbf{w}$ given the explanatory variables and covariance parameters. Equation$~$\ref{eq-marginal2} can be synonymous written after profiling the overall variance out of $\boldsymbol{\Sigma}$, which reduces the dimension of $\boldsymbol{\theta}$ by one for optimization [@wolfinger1994computing]. The restricted multivariate Gaussian density is given by
\begin{equation}\label{eq-reml-def}
[\mathbf{w} | \mathbf{X}, \boldsymbol{\theta}] = \frac{\exp(-\frac{1}{2}(\mathbf{y} - \mathbf{X}\tilde{\boldsymbol{\beta}}) \boldsymbol{\Sigma}^{-1} (\mathbf{y} - \mathbf{X}\tilde{\boldsymbol{\beta}})^T)}{(2 \pi)^{(n - p)/2} |\boldsymbol{\Sigma}|^{1/2}|\mathbf{X}^T \boldsymbol{\Sigma}^{-1} \mathbf{X}|^{1/2}},
\end{equation}
where $\tilde{\boldsymbol{\beta}} = (\mathbf{X}^T \boldsymbol{\Sigma}^{-1} \mathbf{X})^{-1} \mathbf{X}^T \boldsymbol{\Sigma}^{-1} \mathbf{w}$ and $|\cdot|$ denotes the determinant. Next, let 
\begin{equation}\label{eq-marginal03}
  \ell_\mathbf{w} = \log([\mathbf{y} | f^{-1}(\mathbf{w}), \varphi] [\mathbf{w} | \mathbf{X}, \boldsymbol{\theta}])
\end{equation}
and rewrite Equation$~$\ref{eq-marginal2} as 
\begin{equation}\label{eq-marginal3}
  [\mathbf{y}|\mathbf{X}, \varphi, \boldsymbol{\theta}] = \int_{\mathbf{w}} \exp(\ell_\mathbf{w}) d\mathbf{w}.
\end{equation}
A second-order Taylor series expansion of $\ell_\mathbf{w}$ around $\hat{\mathbf{w}}$ yields
\begin{equation}\label{eq-marginal4}
  [\mathbf{y}|\mathbf{X}, \varphi, \boldsymbol{\theta}] \approx \int_{\mathbf{w}} \exp(\ell_{\hat{\mathbf{w}}} + \mathbf{g}^T(\mathbf{w} - \hat{\mathbf{w}}) + \frac{1}{2}(\mathbf{w} - \hat{\mathbf{w}})^T \mathbf{G} (\mathbf{w} - \hat{\mathbf{w}}))d\mathbf{w},
\end{equation}
where $\mathbf{g}$ and $\mathbf{G}$ are the gradient and Hessian, respectively, of $\ell_\mathbf{w}$ with respect to $\mathbf{w}$. If $\hat{\mathbf{w}}$ is a value for which $\mathbf{g} = \mathbf{0}$,
\begin{equation}\label{eq-marginal5}
  [\mathbf{y}|\mathbf{X}, \varphi, \boldsymbol{\theta}] \approx \exp(\ell_{\hat{\mathbf{w}}}) \int_{\mathbf{w}} \exp(-\frac{1}{2}(\mathbf{w} - \hat{\mathbf{w}})^T (-\mathbf{G}) (\mathbf{w} - \hat{\mathbf{w}}))d\mathbf{w}.
\end{equation}
The integral in Equation$~$\ref{eq-marginal5} can be solved by leveraging properties of the normalizing constant of a multivariate Gaussian distribution. Thus, rewriting $\exp(\ell_{\hat{\mathbf{w}}})$ yields
\begin{equation}\label{eq-marginal6}
  [\mathbf{y}|\mathbf{X}, \varphi, \boldsymbol{\theta}] \approx [\mathbf{y} | f^{-1}(\hat{\mathbf{w}}), \varphi] [\hat{\mathbf{w}} | \mathbf{X}, \boldsymbol{\theta}] (2 \pi)^{n/2}|-\mathbf{G}_{\hat{\mathbf{w}}}|^{-1/2}.
\end{equation}

Maximizing the natural logarithm of Equation$~$\ref{eq-marginal6} requires a doubly iterative process over $\boldsymbol{\theta}$ and $\varphi$ as well as $\mathbf{w}$, eventually yielding the the marginal restricted maximum likelihood estimators $\hat{\varphi}$ and $\hat{\boldsymbol{\theta}}$ and their corresponding values of $\hat{\mathbf{w}}$. Maximizing this log likelihood is a computationally expensive operation that involves repeatedly evaluating $\boldsymbol{\Sigma}^{-1}$, $\mathbf{g}$, and $\mathbf{G}$; see @ver2024marginal for more details and forms of $\mathbf{g}$ and $\mathbf{G}$ for various response distributions.

## Estimating fixed effects

@ver2024marginal show that the fixed effect estimator is $\hat{\boldsymbol{\beta}} = (\mathbf{X}^T \hat{\boldsymbol{\Sigma}}^{-1}\mathbf{X})^{-1}\mathbf{X}^T \hat{\boldsymbol{\Sigma}}^{-1}\mathbf{w}$, where $\hat{\boldsymbol{\Sigma}}$ is the covariance matrix $\boldsymbol{\Sigma}$ evaluated at $\hat{\boldsymbol{\theta}}$.  

## Predicting at new locations

@ver2024marginal also derive the covariance matrix of $\hat{\boldsymbol{\beta}}$ and show how to predict $\mathbf{w}$ at unobserved locations and quantify their uncertainties.

# Modeling moose presence in Alaska, USA {#sec-applications}

## Additional applications {#sec-applications2}

## Modeling moose counts in Alaska, USA

## Modeling harbor seal trends in Alaska, USA

## Modeling voter turnout in Texas, USA

## Modeling lake conductivity in Southwest, USA



\bibliography{references.bib}
